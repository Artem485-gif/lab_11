import pandas as pd

# Словник з практичної роботи №5
команди = {
    "Динамо": 40,
    "Шахтар": 42,
    "Рух": 39,
    "Олександрія": 37,
    "Ворскла": 31,
    "Десна": 30,
    "Львів": 25,
    "Олімпік": 24,
    "Зоря": 20
}

# Виводимо вміст словника
print("-----Вміст словника-----")
for команда, очки in команди.items():
    print(f"{команда}: {очки} очок")

# Доповнюємо словник новими даними
команди["Дніпро-1"] = 35
команди["Металіст"] = 28
команди["Нафтовик"] = 22

print("\n-----Доповнений словник-----")
for команда, очки in команди.items():
    print(f"{команда}: {очки} очок")

# Перетворюємо словник на DataFrame
df = pd.DataFrame(list(команди.items()), columns=['Команда', 'Очки'])

# Додаємо нові стовпці з додатковими характеристиками
df['Місто'] = ['Київ', 'Донецьк', 'Львів', 'Олександрія', 'Полтава',
               'Чернігів', 'Львів', 'Донецьк', 'Луганськ', 'Дніпро',
               'Харків', 'Охтирка']
df['Кількість_матчів'] = [26, 16, 22, 20, 31, 19, 19, 26, 26, 22, 27, 20]

print("\n-----Базовий аналіз даних-----")

#Виведіть перші 3 рядки DataFrame
print("Перші 3 рядки DataFrame:")
print(df.head(3))

#Перевірте типи даних
print("\nТипи даних:")
print(df.dtypes)

#Визначте кількість рядків і стовпців
print(f"\nКількість рядків і стовпців: {df.shape}")

#Отримайте описову статистику
print("\nОписова статистика:")
print(df.describe())

print("Додаємо новий стовпець")

# Додаємо розрахунковий стовпець (середні очки за матч)
df['Середні_очки_за_матч'] = df['Очки'] / df['Кількість_матчів']

print("DataFrame з новим стовпцем:")
print(df)

print("-----ФІЛЬТРАЦІЯ ДАНИХ-----")

# Фільтруємо команди з понад 30 очками
команди_понад_30 = df[df['Очки'] > 30]
print("Команди з понад 30 очками:")
print(команди_понад_30[['Команда', 'Очки']])

print("------Сортування даних-----")

# Сортування за спаданням очок
сорт_за_очками = df.sort_values('Очки', ascending=False)
print("Сортування за спаданням очок:")
print(сорт_за_очками[['Команда', 'Очки']])

# Сортування за кількістю матчів
сорт_за_матчами = df.sort_values('Кількість_матчів', ascending=False)
print("\nСортування за кількістю матчів:")
print(сорт_за_матчами[['Команда', 'Кількість_матчів']])

print("-----Групування даних-----")

# Групуємо за містом та знаходимо середнє значення очок
середні_очки_по_містах = df.groupby('Місто')['Очки'].mean()
print("Середня кількість очок по містах:")
print(середні_очки_по_містах)

# Групуємо за містом та знаходимо середні очки за матч
середні_очки_за_матч_по_містах = df.groupby('Місто')['Середні_очки_за_матч'].mean()
print("\nСередні очки за матч по містах:")
print(середні_очки_за_матч_по_містах)

print("\n" + "_"*50)
print("-----------Додаткові операції агрегації-----------")

# Максимальна кількість очок у місті
макс_очки_по_містах = df.groupby('Місто')['Очки'].max()
print("Максимальна кількість очок по містах:")
print(макс_очки_по_містах)

# Кількість унікальних міст
унікальні_міста = df['Місто'].nunique()
print(f"\nКількість унікальних міст: {унікальні_міста}")

# Кількість команд у кожному місті
команди_по_містах = df.groupby('Місто')['Команда'].count()
print("\nКількість команд по містах:")
print(команди_по_містах)

# Знаходимо команду з найбільшою кількістю очок
макс_очки = df['Очки'].max()
команда_макс = df[df['Очки'] == макс_очки]['Команда'].values[0]
print(f"Команда з найбільшою кількістю очок: {команда_макс} ({макс_очки} очок)")

# Знаходимо команду з найменшою кількістю очок
мін_очки = df['Очки'].min()
команда_мін = df[df['Очки'] == мін_очки]['Команда'].values[0]
print(f"Команда з найменшою кількістю очок: {команда_мін} ({мін_очки} очок)")

# Знаходимо команду з найвищими середніми очками за матч
макс_середні = df['Середні_очки_за_матч'].max()
команда_макс_середні = df[df['Середні_очки_за_матч'] == макс_середні]['Команда'].values[0]  # Виправлено назву стовпця
print(f"Команда з найвищими середніми очками за матч: {команда_макс_середні} ({макс_середні:.2f})")

# Виводимо повний DataFrame для перегляду
print("\n" + "_"*50)
print("-----------------ПОВНИЙ DATAFRAME-----------------")
print(df)
